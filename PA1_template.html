<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta name="generator" content="pandoc" />



<title></title>

<script src="PA1_template_files/jquery-1.11.0/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link href="PA1_template_files/bootstrap-2.3.2/css/bootstrap.min.css" rel="stylesheet" />
<link href="PA1_template_files/bootstrap-2.3.2/css/bootstrap-responsive.min.css" rel="stylesheet" />
<script src="PA1_template_files/bootstrap-2.3.2/js/bootstrap.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<link rel="stylesheet"
      href="PA1_template_files/highlight/default.css"
      type="text/css" />
<script src="PA1_template_files/highlight/highlight.js"></script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
</style>
<div class="container-fluid main-container">




<div id="reproducible-research-peer-assessment-1" class="section level1">
<h1>Reproducible Research: Peer Assessment 1</h1>
</div>
<div id="loading-and-preprocessing-the-data" class="section level1">
<h1>Loading and preprocessing the data</h1>
<pre class="r"><code>activity = read.csv(&quot;activity.csv&quot;, header = T)
activity$Date &lt;- as.Date(activity$date, &quot;%Y-%m-%d&quot;)</code></pre>
</div>
<div id="what-is-mean-total-number-of-steps-taken-per-day" class="section level1">
<h1>What is mean total number of steps taken per day?</h1>
<pre class="r"><code>act.complete &lt;- activity[complete.cases(activity),]
act.complete &lt;- tbl_df(act.complete)
daily.steps.sum &lt;- group_by(act.complete, Date)%.%
         summarize(steps.sum = sum(steps))
ggplot(data = daily.steps.sum, aes(x = steps.sum))+ 
        geom_histogram(fill = &quot;white&quot; , col = &quot;black&quot;)+
        labs(x = &quot;Steps Per Day&quot;, title = &quot;Total number of daily steps&quot;)</code></pre>
<p><img src="PA1_template_files/figure-html/Q1.png" title="" alt="" width="600" /></p>
<p>A histogram of total nubmer of daily steps is plotted. The mean and median total number of steps taken each day are 1.0766 × 10<sup>4</sup> and 10765 respectively.</p>
</div>
<div id="what-is-the-average-daily-activity-pattern" class="section level1">
<h1>What is the average daily activity pattern?</h1>
<pre class="r"><code>daily.steps.mean &lt;- group_by(act.complete, interval)%.%
        summarize(steps.mean = mean(steps))

steps.max &lt;- max(daily.steps.mean$steps.mean)
interval.max &lt;- filter(daily.steps.mean, steps.mean == steps.max)$interval

ggplot(data = daily.steps.mean, aes(x = interval, y = steps.mean))+
        geom_line()+
        scale_x_continuous(breaks = seq(0,2400, by = 100))+
        geom_point(col = &quot;red&quot;, aes(x = interval.max, y = steps.max))+
        geom_text(label = paste(&quot;Interval = &quot;, interval.max), 
                  aes(x = interval.max, y = steps.max, hjust = 1.2), 
                  size = 4, col = &quot;red&quot;)+
        labs(x = &quot;Interval&quot;, 
             y = &quot;Average Daily Steps&quot;,
             title = &quot;Average Daily Activity Pattern&quot;)+
        theme(axis.text.x = element_text(angle = 60, hjust = 1))

#         geom_point(col = &quot;red&quot;, aes(x = date.max, y = steps.max))+
#         labs(x = &quot;Date&quot;, 
#              y = &quot;Average Daily Steps&quot;,
#              title = &quot;Average Daily Activity Pattern&quot;)</code></pre>
<p><img src="PA1_template_files/figure-html/Q2.png" title="" alt="" width="600" /></p>
<p>The average daily acitivty pattern is plotted on the average daily steps against the interval recorded. Shown as a red dot in the plot is the maximum average daily step (206.17), recorded in the 835th interval.</p>
</div>
<div id="imputing-missing-values" class="section level1">
<h1>Imputing missing values</h1>
<pre class="r"><code>missing.value.N &lt;- sum(is.na(activity$steps))
missing.value.percentage &lt;- missing.value.N/dim(activity)[1]

# find which interval has NA values
date.with.NA &lt;- unique(activity[is.na(activity$steps),]$Date)
act.with.NA &lt;- filter(activity, Date %in% date.with.NA)

g &lt;- group_by(act.complete, interval)%.% summarize(steps.mean = mean(steps))
steps.mean.byInterval &lt;- g$steps.mean

act.with.NA$steps = steps.mean.byInterval
act.imputed &lt;- rbind(act.complete, act.with.NA)</code></pre>
<p>Considering the presence of some amount of missing data coded as NA (n = 2304, constiting 13.1% of total data) in he dataset, which may lead to biased conclusion, the imputation, which fills in all the missing data, was performed. Briefly, the mean values at the each 5 min interval across the days was chosed to replace the missing values.</p>
<pre class="r"><code>daily.steps.sum.imp &lt;- group_by(act.imputed, Date)%.%
        summarize(steps.sum = sum(steps))
ggplot(data = daily.steps.sum.imp, aes(x = steps.sum))+ 
        geom_histogram(fill = &quot;white&quot; , col = &quot;black&quot;)+
        labs(x = &quot;Steps Per Day&quot;, title = &quot;Total number of daily steps&quot;)</code></pre>
<pre><code>## stat_bin: binwidth defaulted to range/30. Use &#39;binwidth = x&#39; to adjust this.</code></pre>
<p><img src="PA1_template_files/figure-html/histo_on_imputed_dataset.png" title="plot of chunk histo_on_imputed_dataset" alt="plot of chunk histo_on_imputed_dataset" width="600" /></p>
<p>After imputation, the adjusted mean and median total number of steps taken each day are 1.0766 × 10<sup>4</sup> and 1.0766 × 10<sup>4</sup> respectively.</p>
</div>
<div id="are-there-differnces-in-activity-patterns-between-weekdays-and-weekends" class="section level1">
<h1>Are there differnces in activity patterns between weekdays and weekends</h1>
<pre class="r"><code>weekend &lt;- weekdays(act.imputed$Date) %in% c(&quot;Saturday&quot;, &quot;Sunday&quot;)
act.imputed$days = ifelse(weekend, &quot;weekend&quot;, &quot;weekday&quot;)
act.imputed.su &lt;- group_by(act.imputed, days, interval)%.%
        summarize(steps.mean = mean(steps))
ggplot(data = act.imputed.su, aes(x = interval, y = steps.mean))+
        geom_line()+
        facet_grid(days ~ .)+
        labs(x = &quot;Interval&quot;, y = &quot;Number of steps&quot;,
             title = &quot;Activity pattern between weekdays and weekends&quot;)</code></pre>
<p><img src="PA1_template_files/figure-html/Q3.png" title="" alt="" width="600" /></p>
<p>In both cases, the first activity peak occurs approximately before the 1000th interval. When compared to that on weekdays, the activity pattern on weekends is more evenly distubuted as indicated by average daily steps across all the interval recorded.</p>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

<!-- dynamically load mathjax for compatibility with --self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
